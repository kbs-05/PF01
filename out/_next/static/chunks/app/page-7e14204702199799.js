(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8654:(e,t,s)=>{Promise.resolve().then(s.bind(s,9613))},9613:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>E});var a=s(5155),n=s(2115);function r(){let[e,t]=(0,n.useState)(!1);return(0,a.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"container mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)("i",{className:"ri-school-line text-white w-6 h-6 flex items-center justify-center"})}),(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Pierre de la Fontaine"})]})}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>t(!e),className:"flex items-center space-x-2 px-3 py-2 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("i",{className:"ri-user-line text-blue-600 w-4 h-4 flex items-center justify-center"})}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Caissier"}),(0,a.jsx)("i",{className:"ri-arrow-down-s-line w-4 h-4 flex items-center justify-center text-gray-400"})]}),e&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border py-1 z-10",children:[(0,a.jsxs)("a",{href:"#",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)("i",{className:"ri-user-settings-line w-4 h-4 mr-2 flex items-center justify-center"}),"Profil"]}),(0,a.jsxs)("a",{href:"#",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)("i",{className:"ri-settings-line w-4 h-4 mr-2 flex items-center justify-center"}),"Param\xe8tres"]}),(0,a.jsx)("hr",{className:"my-1"}),(0,a.jsxs)("a",{href:"#",className:"block px-4 py-2 text-sm text-red-600 hover:bg-gray-100",children:[(0,a.jsx)("i",{className:"ri-logout-box-line w-4 h-4 mr-2 flex items-center justify-center"}),"D\xe9connexion"]})]})]})})]})})})}var l=s(3915),i=s(5317),c=s(5404);let d=(0,l.Dk)().length?(0,l.Sx)():(0,l.Wp)({apiKey:"AIzaSyCcVV_FeUdY2y-o-50SXawHhZPSrS4nvVg",authDomain:"pf00-b9e58.firebaseapp.com",projectId:"pf00-b9e58",storageBucket:"pf00-b9e58.firebasestorage.app",messagingSenderId:"815924358207",appId:"1:815924358207:web:689db0dc393a6a18f19c8a",measurementId:"G-0KC2DSNN91"}),o=(0,i.aU)(d);async function m(){try{let e=(0,i.rJ)(o,"students");return(await (0,i.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Erreur r\xe9cup\xe9ration \xe9tudiants :",e),[]}}async function u(){try{let e=(0,i.rJ)(o,"payments");return(await (0,i.GG)(e)).docs.map(e=>{let t,s=e.data();return t="object"==typeof s.date&&null!==s.date&&"toDate"in s.date&&"function"==typeof s.date.toDate?s.date.toDate().toISOString():"string"==typeof s.date?s.date:new Date().toISOString(),{id:e.id,studentName:s.studentName,month:s.month,amount:s.amount,paymentMethod:s.paymentMethod,date:t}})}catch(e){return console.error("Erreur r\xe9cup\xe9ration paiements :",e),[]}}function x(){let[e,t]=(0,n.useState)({totalStudents:0,paidThisMonth:0,totalAmount:0,pendingPayments:0}),[s,r]=(0,n.useState)([]);return(0,n.useEffect)(()=>{!async function(){try{let e=await m(),s=await u(),a=new Date().getMonth()+1,n=new Date().getFullYear(),l=s.filter(e=>{let t=new Date(e.date);return t.getMonth()+1===a&&t.getFullYear()===n}),i=new Set(l.map(e=>e.studentName)),c=s.reduce((e,t)=>e+t.amount,0);t({totalStudents:e.length,paidThisMonth:i.size,totalAmount:c,pendingPayments:e.length-i.size}),r(s.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).slice(0,5))}catch(e){console.error("Erreur chargement donn\xe9es tableau de bord:",e)}}()},[]),(0,a.jsxs)("div",{className:"p-6 bg-gray-50 min-h-screen",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Tableau de Bord"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Total \xc9l\xe8ves"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:e.totalStudents})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"\xc9l\xe8ves ayant pay\xe9 ce mois"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-green-600",children:e.paidThisMonth})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Montant total pay\xe9"}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-indigo-600",children:[e.totalAmount," FCFA"]})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Paiements en attente"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-red-600",children:e.pendingPayments})]})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"R\xe9partition mensuelle des paiements"}),(0,a.jsx)("div",{className:"space-y-4",children:["Septembre","Octobre","Novembre","D\xe9cembre","Janvier","F\xe9vrier","Mars","Avril","Mai"].map((t,n)=>{let r=new Set(s.filter(e=>e.month===t).map(e=>e.studentName)),l=e.totalStudents>0?r.size/e.totalStudents*100:0;return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:t}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(l,"%")}})}),(0,a.jsx)("span",{className:"text-sm text-gray-500 w-12",children:r.size})]})]},n)})})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Derniers paiements"}),(0,a.jsx)("ul",{className:"divide-y divide-gray-200",children:s.map((e,t)=>(0,a.jsxs)("li",{className:"py-2 flex justify-between text-sm",children:[(0,a.jsx)("span",{children:e.studentName}),(0,a.jsx)("span",{children:e.month}),(0,a.jsxs)("span",{children:[e.amount," FCFA"]}),(0,a.jsx)("span",{children:new Date(e.date).toLocaleDateString()})]},t))})]})]})}(0,c.xI)(d);let h=async()=>{let e=(0,i.rJ)(o,"students");return(await (0,i.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))},p=async e=>{let t=(0,i.P)((0,i.rJ)(o,"students"),(0,i._M)("class","==",e));return(await (0,i.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))},b=async e=>({id:(await (0,i.gS)((0,i.rJ)(o,"students"),{...e,createdAt:i.Dc.now()})).id,...e}),g=async()=>{let e=(0,i.rJ)(o,"payments");return(await (0,i.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))},j=async e=>({id:(await (0,i.gS)((0,i.rJ)(o,"payments"),{...e,date:e.date?new Date(e.date):i.Dc.now()})).id,...e}),f=e=>{let t=v(e),s=window.open("","_blank");s&&(s.document.write(t),s.document.close(),s.focus(),s.print())},N=e=>{let t=new Blob([v(e)],{type:"text/html"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="recu_".concat(e.studentName,"_").concat(e.month,"_").concat(e.id,".html"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)},v=e=>'\n  <!DOCTYPE html>\n  <html lang="fr">\n  <head>\n    <meta charset="UTF-8" />\n    <title>Re\xe7u de paiement</title>\n    <style>\n      @media print {\n        @page {\n          size: A5 landscape;\n          margin: 10mm;\n        }\n      }\n\n      body {\n        font-family: Arial, sans-serif;\n        font-size: 13px;\n        margin: 0 auto;\n        padding: 10px;\n        width: 100%;\n        max-width: 580px;\n        line-height: 1.4;\n        color: #212529;\n      }\n\n      .header {\n        text-align: center;\n        border-bottom: 1px solid #333;\n        padding-bottom: 10px;\n        margin-bottom: 10px;\n      }\n\n      .school-name {\n        font-size: 17px;\n        font-weight: bold;\n        color: #2563eb;\n      }\n\n      .contact {\n        font-size: 12px;\n      }\n\n      .receipt-title {\n        font-size: 15px;\n        font-weight: bold;\n        text-align: center;\n        margin: 15px 0;\n        text-decoration: underline;\n      }\n\n      .receipt-info {\n        background-color: #f9f9f9;\n        padding: 12px;\n        border-radius: 6px;\n      }\n\n      .info-row {\n        display: flex;\n        justify-content: space-between;\n        margin: 6px 0;\n        border-bottom: 1px dashed #ccc;\n        padding-bottom: 3px;\n      }\n\n      .info-label {\n        font-weight: bold;\n      }\n\n      .amount {\n        font-weight: bold;\n        font-size: 14px;\n        color: #28a745;\n      }\n\n      .signature {\n        text-align: right;\n        margin-top: 20px;\n      }\n\n      .signature-line {\n        border-top: 1px solid #333;\n        width: 130px;\n        margin-top: 15px;\n        margin-bottom: 5px;\n        float: right;\n      }\n\n      .footer {\n        text-align: center;\n        font-size: 10px;\n        margin-top: 20px;\n        color: #666;\n      }\n    </style>\n  </head>\n  <body>\n    <div class="header">\n      <div class="school-name">Pierre de la Fontaine</div>\n      <div class="contact">AKAE apr\xe8s l\'\xc9cole publique Ozoungue</div>\n      <div class="contact">T\xe9l : 077 71 55 10 / 066 31 07 08 / 077 80 27 78 / 066 30 01 40</div>\n    </div>\n\n    <div class="receipt-title">RE\xc7U DE PAIEMENT</div>\n\n    <div class="receipt-info">\n      <div class="info-row">\n        <span class="info-label">N\xb0 de re\xe7u :</span>\n        <span>'.concat(e.id,'</span>\n      </div>\n      <div class="info-row">\n        <span class="info-label">Ann\xe9e scolaire :</span>\n        <span>').concat(e.academicYear,'</span>\n      </div>\n      <div class="info-row">\n        <span class="info-label">\xc9l\xe8ve :</span>\n        <span>').concat(e.studentName,'</span>\n      </div>\n      <div class="info-row">\n        <span class="info-label">Mois :</span>\n        <span>').concat(e.month,'</span>\n      </div>\n      <div class="info-row">\n        <span class="info-label">Mode :</span>\n        <span>').concat(y(e.paymentMethod),'</span>\n      </div>\n      <div class="info-row">\n        <span class="info-label">Date :</span>\n        <span>').concat(new Date(e.date).toLocaleDateString("fr-FR"),'</span>\n      </div>\n      <div class="info-row">\n        <span class="info-label">Montant :</span>\n        <span class="amount">').concat(e.amount.toLocaleString(),' CFA</span>\n      </div>\n    </div>\n\n    <div class="signature">\n      <div>Signature du caissier</div>\n      <div class="signature-line"></div>\n      <div>Date : ').concat(new Date().toLocaleDateString("fr-FR"),'</div>\n    </div>\n\n    <div class="footer">\n      Merci de conserver ce re\xe7u. Pour toute r\xe9clamation, contactez l\'administration.\n    </div>\n  </body>\n  </html>\n  '),y=e=>{switch(e){case"cash":return"Esp\xe8ces";case"transfer":return"Virement bancaire";case"check":return"Ch\xe8que";case"mobile":return"Mobile Money";default:return e}};function w(){let[e,t]=(0,n.useState)({class:"",studentName:"",studentMatricule:"",month:[],amount:"",academicYear:""}),[s,r]=(0,n.useState)([]),[l,i]=(0,n.useState)("list"),[c,d]=(0,n.useState)(!1),[o,m]=(0,n.useState)(!1),[u,x]=(0,n.useState)(null),[p,b]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{r(await h())})()},[]);let g=e.class?s.filter(t=>t.class===e.class):[],v=e=>{let{name:a,value:n}=e.target;if("class"===a)t(e=>({...e,class:n,studentName:"",studentMatricule:""}));else if("studentName"===a){let e=s.find(e=>e.name===n);t(t=>({...t,studentName:n,studentMatricule:e?e.matricule:""}))}else"month"!==a&&t(e=>({...e,[a]:n}))},y=e=>{i(e),t(e=>({...e,studentName:"",studentMatricule:""}))},w=async t=>{t.preventDefault();let{class:s,studentName:a,studentMatricule:n,month:r,amount:l,academicYear:i}=e;if(!s||!a||!n||0===r.length||!l||!i)return void alert("Veuillez remplir tous les champs obligatoires");m(!0);try{let e={studentName:a,studentMatricule:n,month:r.join(", "),amount:parseFloat(l),paymentMethod:"cash",date:new Date().toISOString(),academicYear:i};await j(e),x({id:Date.now().toString(),...e}),d(!0),b(!0)}catch(e){console.error("Erreur lors du traitement du paiement:",e),alert("Erreur lors du traitement du paiement")}finally{m(!1)}};return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Nouveau paiement"}),c&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("i",{className:"ri-checkbox-circle-line text-green-600 w-5 h-5 mr-2"}),(0,a.jsx)("span",{className:"text-green-800",children:"Paiement enregistr\xe9 avec succ\xe8s !"})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)("button",{onClick:()=>u&&f(u),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700",children:[(0,a.jsx)("i",{className:"ri-printer-line mr-1"})," Imprimer"]}),(0,a.jsxs)("button",{onClick:()=>u&&N(u),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700",children:[(0,a.jsx)("i",{className:"ri-download-line mr-1"})," T\xe9l\xe9charger"]}),(0,a.jsxs)("button",{onClick:()=>{t({class:"",studentName:"",studentMatricule:"",month:[],amount:"",academicYear:""}),i("list"),d(!1),b(!1),x(null)},className:"bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700",children:[(0,a.jsx)("i",{className:"ri-add-line mr-1"})," Nouveau paiement"]})]})]})}),(0,a.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"class",className:"block text-sm font-medium text-gray-700 mb-2",children:"Classe *"}),(0,a.jsxs)("select",{id:"class",name:"class",value:e.class,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,disabled:p,children:[(0,a.jsx)("option",{value:"",children:"S\xe9lectionner une classe"}),["2ANS","3ANS","4ANS","5ANS","CP1","CP2","CE1","CE2","CM1","CM2"].map((e,t)=>(0,a.jsx)("option",{value:e,children:e},t))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"academicYear",className:"block text-sm font-medium text-gray-700 mb-2",children:"Ann\xe9e acad\xe9mique *"}),(0,a.jsx)("input",{type:"text",id:"academicYear",name:"academicYear",placeholder:"2024-2025",value:e.academicYear,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,disabled:p})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom de l'\xe9l\xe8ve *"}),(0,a.jsxs)("div",{className:"flex space-x-4 mb-3",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",name:"studentInputType",value:"list",checked:"list"===l,onChange:()=>y("list"),className:"mr-2",disabled:p})," Liste"]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",name:"studentInputType",value:"manual",checked:"manual"===l,onChange:()=>y("manual"),className:"mr-2",disabled:p})," Manuel"]})]}),"list"===l?(0,a.jsxs)("select",{id:"studentName",name:"studentName",value:e.studentName,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,disabled:!e.class||p,children:[(0,a.jsx)("option",{value:"",children:e.class?"S\xe9lectionner un \xe9l\xe8ve":"Choisir d'abord une classe"}),g.map(e=>(0,a.jsxs)("option",{value:e.name,children:[e.name," (",e.matricule,")"]},e.id))]}):(0,a.jsx)("input",{type:"text",id:"studentName",name:"studentName",value:e.studentName,onChange:v,placeholder:"Nom de l'\xe9l\xe8ve",className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,disabled:p})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"month",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mois de paiement *"}),(0,a.jsx)("select",{id:"month",name:"month",multiple:!0,value:e.month,onChange:e=>{let s=Array.from(e.target.selectedOptions).map(e=>e.value);t(e=>({...e,month:s}))},className:"w-full h-40 px-3 py-2 border border-gray-300 rounded-lg",required:!0,disabled:p,children:["INSCRIPTION","FOURNITURE","TENUE","POLO","POLO DE SPORT","Septembre","Octobre","Novembre","D\xe9cembre","Janvier","F\xe9vrier","Mars","Avril","Mai"].map((e,t)=>(0,a.jsx)("option",{value:e,children:e},t))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 mb-2",children:"Montant (CFA) *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"number",id:"amount",name:"amount",value:e.amount,onChange:v,placeholder:"15000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,disabled:p}),(0,a.jsx)("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm",children:"CFA"})]})]})]}),!p&&(0,a.jsx)("div",{className:"flex space-x-4",children:(0,a.jsx)("button",{type:"submit",disabled:o,className:"flex-1 bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50",children:o?(0,a.jsxs)(a.Fragment,{children:[" ",(0,a.jsx)("i",{className:"ri-loader-4-line animate-spin w-5 h-5 mr-2"})," Traitement... "]}):(0,a.jsxs)(a.Fragment,{children:[" ",(0,a.jsx)("i",{className:"ri-money-dollar-circle-line w-5 h-5 mr-2"})," Enregistrer le paiement "]})})})]})]})})}function S(){let[e,t]=(0,n.useState)([]),[s,r]=(0,n.useState)([]),[l,i]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),o=["INSCRIPTION","FOURNITURE","TENUE","POLO","POLO DE SPORT","Septembre","Octobre","Novembre","D\xe9cembre","Janvier","F\xe9vrier","Mars","Avril","Mai"];(0,n.useEffect)(()=>{!async function(){try{let e=await h();t(e);let s=await g();r(s)}catch(e){console.error("Erreur lors du chargement des donn\xe9es:",e)}}()},[]);let m=e.filter(e=>{let t=e.name.toLowerCase().includes(l.toLowerCase())||e.matricule.toLowerCase().includes(l.toLowerCase()),s=""===c||e.class===c;return t&&s}),u=Array.from(new Set(e.map(e=>e.class))),x=(e,t)=>s.some(s=>s.studentName===e&&s.month.split(",").map(e=>e.trim()).includes(t));return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Suivi des paiements"}),(0,a.jsxs)("button",{onClick:()=>{let e=new Blob([[["Matricule","Nom","Classe",...o],...m.map(e=>[e.matricule,e.name,e.class,...o.map(t=>x(e.name,t)?"Pay\xe9":"Non pay\xe9")])].map(e=>e.join(",")).join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="suivi_paiements.csv",s.click(),window.URL.revokeObjectURL(t)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2 whitespace-nowrap cursor-pointer",children:[(0,a.jsx)("i",{className:"ri-download-line w-4 h-4 flex items-center justify-center"}),(0,a.jsx)("span",{children:"Exporter CSV"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)("input",{type:"text",placeholder:"Rechercher un \xe9l\xe8ve ou matricule...",value:l,onChange:e=>i(e.target.value),className:"w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"}),(0,a.jsx)("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 flex items-center justify-center"})]}),(0,a.jsxs)("div",{className:"sm:w-48 relative",children:[(0,a.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none pr-8 text-sm",children:[(0,a.jsx)("option",{value:"",children:"Toutes les classes"}),u.map((e,t)=>(0,a.jsx)("option",{value:e,children:e},t))]}),(0,a.jsx)("i",{className:"ri-arrow-down-s-line absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 flex items-center justify-center pointer-events-none"})]})]}),(0,a.jsx)("div",{className:"bg-white border rounded-lg overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Matricule"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\xc9l\xe8ve"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Classe"}),o.map((e,t)=>(0,a.jsx)("th",{className:"px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.length>5?e.substring(0,5):e.substring(0,3)},t))]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===m.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:3+o.length,className:"text-center py-8 text-gray-500",children:"Aucun \xe9l\xe8ve trouv\xe9"})}):m.map((e,t)=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:e.matricule}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:(0,a.jsx)("i",{className:"ri-user-line text-blue-600 w-4 h-4 flex items-center justify-center"})}),(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:e.class})}),o.map((t,s)=>(0,a.jsx)("td",{className:"px-3 py-4 text-center",children:x(e.name,t)?(0,a.jsx)("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:(0,a.jsx)("i",{className:"ri-check-line text-green-600 w-4 h-4 flex items-center justify-center"})}):(0,a.jsx)("div",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center mx-auto",children:(0,a.jsx)("i",{className:"ri-close-line text-gray-400 w-4 h-4 flex items-center justify-center"})})},s))]},e.id||t))})]})})}),(0,a.jsx)("div",{className:"mt-4 text-sm text-gray-600",children:(0,a.jsxs)("p",{children:["Total: ",m.length," \xe9l\xe8ve",m.length>1?"s":""]})})]})}var C=s(3319);function M(){let[e,t]=(0,n.useState)([]),[s,r]=(0,n.useState)(""),[l,c]=(0,n.useState)(""),[d,o]=(0,n.useState)("date");(0,n.useEffect)(()=>{(async()=>{try{let e=await g();t(e)}catch(e){console.error("Erreur lors du chargement des paiements:",e)}})()},[]);let m=e.filter(e=>e.studentName.toLowerCase().includes(s.toLowerCase())||e.studentMatricule.toLowerCase().includes(s.toLowerCase())).filter(e=>!l||e.month===l).sort((e,t)=>{if("amount"===d)return t.amount-e.amount;if("student"===d)return e.studentName.localeCompare(t.studentName);let s=x(e.date);return x(t.date).getTime()-s.getTime()}),u=m.reduce((e,t)=>e+t.amount,0);function x(e){if(!e)return new Date(0);if(e instanceof i.Dc)return e.toDate();let t=new Date(e);return isNaN(t.getTime())?new Date(0):t}return(0,a.jsxs)("div",{className:"p-4 max-w-5xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Suivi des paiements"}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center gap-4 mb-6",children:[(0,a.jsx)("input",{type:"text",placeholder:"Rechercher un \xe9l\xe8ve ou matricule",value:s,onChange:e=>r(e.target.value),className:"border p-2 rounded w-full md:w-1/3"}),(0,a.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:"border p-2 rounded w-full md:w-1/4",children:[(0,a.jsx)("option",{value:"",children:"Tous les mois"}),["INSCRIPTION","FOURNITURE","TENUE","POLO","POLO DE SPORT","Septembre","Octobre","Novembre","D\xe9cembre","Janvier","F\xe9vrier","Mars","Avril","Mai"].map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),(0,a.jsxs)("select",{value:d,onChange:e=>o(e.target.value),className:"border p-2 rounded w-full md:w-1/4",children:[(0,a.jsx)("option",{value:"date",children:"Trier par date"}),(0,a.jsx)("option",{value:"amount",children:"Trier par montant"}),(0,a.jsx)("option",{value:"student",children:"Trier par nom"})]})]}),(0,a.jsxs)("div",{className:"mb-4 text-lg font-semibold",children:["Montant total : ",(0,a.jsxs)("span",{className:"text-green-600",children:[u.toLocaleString()," FCFA"]})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full bg-white border rounded shadow",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-100 text-left",children:[(0,a.jsx)("th",{className:"p-3 border",children:"Nom de l'\xe9l\xe8ve"}),(0,a.jsx)("th",{className:"p-3 border",children:"Matricule"}),(0,a.jsx)("th",{className:"p-3 border",children:"Mois"}),(0,a.jsx)("th",{className:"p-3 border",children:"Montant"}),(0,a.jsx)("th",{className:"p-3 border",children:"Mode de paiement"}),(0,a.jsx)("th",{className:"p-3 border",children:"Date"})]})}),(0,a.jsxs)("tbody",{children:[0===m.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"text-center p-4",children:"Aucun paiement trouv\xe9"})}),m.map(e=>{let t=x(e.date);return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"p-3 border",children:e.studentName}),(0,a.jsx)("td",{className:"p-3 border",children:e.studentMatricule}),(0,a.jsx)("td",{className:"p-3 border",children:e.month}),(0,a.jsxs)("td",{className:"p-3 border",children:[e.amount.toLocaleString()," FCFA"]}),(0,a.jsx)("td",{className:"p-3 border",children:e.paymentMethod}),(0,a.jsx)("td",{className:"p-3 border",children:t.getTime()>0?(0,C.GP)(t,"dd/MM/yyyy"):"Date invalide"})]},e.id)})]})]})})]})}function D(){let[e,t]=(0,n.useState)({nom:"",prenom:"",classe:"",matricule:""}),[s,r]=(0,n.useState)(!1),[l,i]=(0,n.useState)(!1),c=e=>{let{name:s,value:a}=e.target;t(e=>({...e,[s]:a}))},d=async e=>{let t=await p(e),s=0;t.forEach(e=>{if(e.matricule){let t=parseInt(e.matricule.split("-")[1],10);!isNaN(t)&&t>s&&(s=t)}});let a=String(s+1).padStart(3,"0");return"".concat(e,"-").concat(a)},o=async s=>{s.preventDefault(),r(!0);try{let s=await d(e.classe),a={name:e.nom+" "+e.prenom,class:e.classe,matricule:s,parentName:"",parentPhone:""};await b(a),i(!0),t({nom:"",prenom:"",classe:"",matricule:""})}catch(e){console.error("Erreur lors de l'ajout :",e),i(!1)}finally{r(!1)}};return(0,a.jsxs)("div",{className:"max-w-md mx-auto mt-10 p-6 bg-white rounded-xl shadow-md",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Ajouter un \xe9l\xe8ve"}),(0,a.jsxs)("form",{onSubmit:o,className:"space-y-4",children:[(0,a.jsx)("input",{type:"text",name:"nom",placeholder:"Nom",value:e.nom,onChange:c,className:"w-full p-2 border rounded",required:!0}),(0,a.jsx)("input",{type:"text",name:"prenom",placeholder:"Pr\xe9nom",value:e.prenom,onChange:c,className:"w-full p-2 border rounded",required:!0}),(0,a.jsx)("input",{type:"text",name:"matricule",placeholder:"Matricule (g\xe9n\xe9r\xe9 automatiquement)",value:e.matricule,className:"w-full p-2 border rounded bg-gray-100",disabled:!0}),(0,a.jsxs)("select",{name:"classe",value:e.classe,onChange:c,className:"w-full p-2 border rounded",required:!0,children:[(0,a.jsx)("option",{value:"",children:"S\xe9lectionner une classe"}),(0,a.jsx)("option",{value:"2ANS",children:"2ANS"}),(0,a.jsx)("option",{value:"3ANS",children:"3ANS"}),(0,a.jsx)("option",{value:"4ANS",children:"4ANS"}),(0,a.jsx)("option",{value:"5ANS",children:"5ANS"}),(0,a.jsx)("option",{value:"CP1",children:"CP1"}),(0,a.jsx)("option",{value:"CP2",children:"CP2"}),(0,a.jsx)("option",{value:"CE1",children:"CE1"}),(0,a.jsx)("option",{value:"CE2",children:"CE2"}),(0,a.jsx)("option",{value:"CM1",children:"CM1"}),(0,a.jsx)("option",{value:"CM2",children:"CM2"})]}),(0,a.jsx)("button",{type:"submit",disabled:s,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:s?"Ajout en cours...":"Ajouter"}),l&&(0,a.jsx)("p",{className:"text-green-600",children:"\xc9l\xe8ve ajout\xe9 avec succ\xe8s âœ…"})]})]})}function E(){let[e,t]=(0,n.useState)("dashboard");return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(r,{}),(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex space-x-1 mb-8 bg-white rounded-lg p-1 shadow-sm",children:[(0,a.jsxs)("button",{onClick:()=>t("dashboard"),className:"px-6 py-3 rounded-md font-medium transition-colors whitespace-nowrap ".concat("dashboard"===e?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"),children:[(0,a.jsx)("i",{className:"ri-dashboard-line w-5 h-5 mr-2 flex items-center justify-center"}),"Tableau de bord"]}),(0,a.jsxs)("button",{onClick:()=>t("payment"),className:"px-6 py-3 rounded-md font-medium transition-colors whitespace-nowrap ".concat("payment"===e?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"),children:[(0,a.jsx)("i",{className:"ri-money-dollar-circle-line w-5 h-5 mr-2 flex items-center justify-center"}),"Nouveau paiement"]}),(0,a.jsxs)("button",{onClick:()=>t("students"),className:"px-6 py-3 rounded-md font-medium transition-colors whitespace-nowrap ".concat("students"===e?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"),children:[(0,a.jsx)("i",{className:"ri-group-line w-5 h-5 mr-2 flex items-center justify-center"}),"Liste des \xe9l\xe8ves"]}),(0,a.jsxs)("button",{onClick:()=>t("history"),className:"px-6 py-3 rounded-md font-medium transition-colors whitespace-nowrap ".concat("history"===e?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"),children:[(0,a.jsx)("i",{className:"ri-history-line w-5 h-5 mr-2 flex items-center justify-center"}),"Historique"]}),(0,a.jsxs)("button",{onClick:()=>t("addStudent"),className:"px-6 py-3 rounded-md font-medium transition-colors whitespace-nowrap ".concat("addStudent"===e?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"),children:[(0,a.jsx)("i",{className:"ri-user-add-line w-5 h-5 mr-2 flex items-center justify-center"}),"Ajouter \xe9l\xe8ve"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:["dashboard"===e&&(0,a.jsx)(x,{}),"payment"===e&&(0,a.jsx)(w,{}),"students"===e&&(0,a.jsx)(S,{}),"history"===e&&(0,a.jsx)(M,{}),"addStudent"===e&&(0,a.jsx)(D,{})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[135,965,549,441,684,358],()=>t(8654)),_N_E=e.O()}]);